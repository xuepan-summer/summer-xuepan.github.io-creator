---
title: "常用JVM分析工具"
date: 2020-10-10T16:25:12+08:00
draft: false
---

项目里出现了full GC问题之后，当时使用了Visual VM这种可视化工具发现了问题所在，但是日常开发也不能拘泥于这一种工具，还是应该多看看其他的工具，结合着使用，毕竟工具各有利弊。所以把这些工具和作用总结一下，便于使用时查阅。

<u>常见jdk工具（命令行）</u>

1. jps（JVM Process Status Tool）获取java进程的ID

2. jstat（JVM Statistics Monitoring Tool）监视java进程的运行状态信息

3. jinfo（Configuration Info for Java）获取java进程的配置信息，包括JVM的配置信息和系统属性

4. jmap（Memory Map for Java）查看堆的使用情况且完成堆到文件的一个转储

5. jhat（JVM Heap Dump Broswer）分析用jmap转储的二进制文件，通过浏览器可以查看jhat分析的结果

6. jstack（Stack Trace for Java）查看应用程序的堆栈信息

<u>常见jdk工具（可视化）</u>

其实就是将上述的这个工具组合起来，以图形化页面展示出来

1. JConsole

2. Visual VM（1.5之后jdk已经自带了，可以直接使用，又名jVisual VM [java visual VM] ）



使用工具是为了帮助我们发现问题，而在解决问题的时候，主要分析以下两点：**内存分析和线程分析**，分析具体又包括这四个方面--监视、转储、快照和性能分析

**监视**：看CPU使用情况、内存使用情况、线程状态及其他信息，例如JConsole、Visual VM、JStack都可以

**转储**：从内存中获取当前状态数据并转储到文件，用于进行静态的性能分析

包括系统转储、Java转储、堆转储

1. 系统转储：又称核心转储，一般使用相关工具，例如Windows的windbg和Linux的gdb

2. Java转储：JVM内部生成的格式化的数据，包括线程信息，类的加载信息，堆的统计数据等，通常用于检测死锁

3. 堆转储：所有对象的堆内容

**快照**：快照包含了应用程序在一段时间内的执行信息，通常包括CPU快照和内存快照两重

1. CPU快照：主要包含应用程序重函数的调用关系及运行时间

2. 内存快照：主要包含了内存的分配和使用情况、载入的类、存在的对象信息及对象间的引用关系等

**性能分析**：帮助开发人员定位程序需要被优化的部分，进而提高程序运行速度或内存使用效率

1. CPU性能分析：统计函数的调用情况及执行时间或CPU的使用情况，一般看CPU监视和CPU快照

2. 内存性能分析：统计内存使用情况，检测可能出现的内存泄露问题及确定优化内存使用的方向，一般看内存监视和内存快照

3. 线程性能分析：一般在多线程情况下确定内存的问题所在，一般包括线程的状态变化情况、死锁情况和某个线程在线程生命期内状态的分布情况
